# 愤怒的小鸟游戏 - 基础框架版

基于 Phaser 3 + Matter.js + Vite 的游戏开发框架。

## 当前版本：v0.6.0 碰撞伤害系统

基于 Phaser 3 + Matter.js 的愤怒的小鸟游戏，已实现程序化图形生成、建筑方块系统、猪系统、小鸟系统、弹弓系统和碰撞伤害计算。

### 已实现功能 ✅

- ✅ **项目配置** - Vite 开发环境，支持热更新
- ✅ **基础场景系统** - 启动场景、主菜单、关卡选择、游戏场景
- ✅ **Matter.js 物理引擎** - 完整的物理世界配置
- ✅ **程序化图形生成系统** - 动态生成所有游戏对象纹理（小鸟、猪、方块、弹弓）
- ✅ **建筑方块系统** - Block 类，支持木头/石头/玻璃三种材质
  - 不同材质的物理属性（密度、摩擦力、弹性）
  - 耐久度系统（HP: 木头100, 石头300, 玻璃50）
  - 受伤效果（透明度变化、红色闪烁）
  - 销毁动画（淡出 + 缩小）
- ✅ **猪系统** - Pig 类，支持小/中/大三种尺寸
  - 不同尺寸的生命值（HP: 小80, 中150, 大250）
  - 不同尺寸的分数（小5000, 中10000, 大15000）
  - 受伤效果（透明度、闪烁、抖动）
  - 死亡动画（旋转淡出）
  - 得分系统
- ✅ **小鸟系统** - Bird 基类，支持红鸟/黄鸟/炸弹鸟三种类型
  - 飞行物理（抛物线轨迹、旋转）
  - 状态管理（待机、飞行、着陆、销毁）
  - 特殊能力系统
    - 红鸟：无特殊能力（基础攻击）
    - 黄鸟：加速能力（速度×2）
    - 炸弹鸟：爆炸能力（范围伤害）
  - 点击发射、空格使用能力
  - 自动着陆检测和清理
- ✅ **弹弓系统** - Slingshot 类，完整的弹弓发射机制
  - 拖拽交互（拖动小鸟蓄力）
  - 力度计算（基于拉伸距离）
  - 轨迹预测（实时显示抛物线轨迹）
  - 小鸟队列管理（自动加载下一只小鸟）
  - 拉力限制（最大/最小拉伸距离）
  - 橡皮筋视觉效果（动态绘制）
- ✅ **UI 框架** - 菜单、按钮交互、统计信息显示、实时分数

### 待实现功能 📋

- ⬜ 碰撞伤害计算 - 基于速度的伤害公式和对象销毁逻辑
- ⬜ 关卡数据和管理器
- ⬜ 相机跟随系统
- ⬜ 分数和星级系统

## 快速开始

### 1. 安装依赖
```bash
npm install
```

### 2. 启动开发服务器
```bash
npm run dev
```

游戏将在浏览器中打开：http://localhost:3000

### 3. 构建生产版本
```bash
npm run build
```

## 项目结构

```
angry-birds/
├── src/
│   ├── main.js                 # 游戏入口，Phaser 配置
│   ├── scenes/
│   │   ├── BootScene.js        # 启动场景，生成纹理
│   │   ├── MenuScene.js        # 主菜单
│   │   ├── LevelSelectScene.js # 关卡选择（占位符）
│   │   ├── GameScene.js        # 游戏场景（弹弓+小鸟+方块+猪）
│   │   └── UIScene.js          # UI场景（占位符）
│   ├── objects/
│   │   ├── Block.js            # 建筑方块类
│   │   ├── Pig.js              # 猪类
│   │   ├── Bird.js             # 小鸟基类（红鸟/黄鸟/炸弹鸟）
│   │   └── Slingshot.js        # 弹弓类
│   └── utils/
│       ├── constants.js        # 常量配置
│       └── GraphicsGenerator.js # 程序化图形生成器
├── index.html
├── package.json
├── vite.config.js
├── CLAUDE.md                   # 开发计划和规范
└── README.md
```

## 当前演示功能

### 主菜单
- 显示游戏标题和开始按钮
- 标题呼吸动画效果

### 游戏场景（测试关卡）
- **物理地面** - 静态地面，带草地纹理
- **建筑结构** - 三座测试塔（木头塔、石头塔、玻璃塔）
- **猪目标** - 5只猪分布在不同位置（小、中、大尺寸）
- **小鸟发射** - 3只小鸟（红鸟、黄鸟、炸弹鸟），点击发射
- **特殊能力** - 空格键激活小鸟能力（黄鸟加速、炸弹鸟爆炸）
- **伤害系统** - 碰撞造成伤害，对象受伤效果和销毁动画
- **得分系统** - 击杀猪获得分数，实时显示
- **统计面板** - 实时显示方块、猪、小鸟数量
- **物理模拟** - 真实的碰撞、重力、摩擦力、抛物线飞行

## 技术栈

- **游戏引擎**: Phaser 3.70.0
- **物理引擎**: Matter.js (Phaser 内置)
- **构建工具**: Vite 5.0
- **语言**: JavaScript (ES6+)

## 物理配置

```javascript
physics: {
    default: 'matter',
    matter: {
        gravity: { x: 0, y: 1.5 },
        debug: false,
        enableSleeping: true
    }
}
```

## 开发建议

### 添加调试模式
在 `src/main.js` 中设置：
```javascript
physics: {
    matter: {
        debug: true  // 显示物理边界
    }
}
```

### 下一步开发方向

1. **实现弹弓系统**
   - 创建 Slingshot.js 类
   - 实现拖拽交互
   - 力度计算和轨迹预测
   - 替换当前的点击发射机制

2. **完善碰撞伤害系统**
   - 基于速度计算碰撞伤害
   - 完善伤害公式（目前是临时的点击伤害）
   - 添加碰撞音效和特效

3. **添加关卡系统**
   - 创建 LevelManager - 关卡数据管理
   - 设计关卡数据结构（在 `src/data/levels.js`）
   - 实现关卡加载和切换

4. **相机跟随系统**
   - 相机跟随小鸟飞行
   - 平滑过渡和缩放
   - 边界限制

5. **星级评分系统**
   - 完善分数计算规则
   - 三星评级标准
   - 结算界面和统计

## 常见问题

### 如何修改重力？
修改 `src/main.js` 中的 `gravity.y` 值（默认 1.5）

### 如何调整窗口大小？
修改 `src/main.js` 中的 `width` 和 `height` 配置

### 物理性能优化
- 使用 `enableSleeping: true` 让静止物体休眠
- 合理设置物体密度和碰撞分类
- 限制场景中的物体数量

## 许可证

MIT License

## 参考资源

- [Phaser 3 官方文档](https://photonstorm.github.io/phaser3-docs/)
- [Matter.js 文档](https://brm.io/matter-js/docs/)
- [Phaser 3 示例](https://phaser.io/examples)

---

**基础框架已就绪，开始构建您的愤怒的小鸟游戏吧！** 🎮
